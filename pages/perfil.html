<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Noé Medina">
    <meta name="description" content="Ginasio basicamente">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/estilos.css">
    <link rel="icon" type="png" href="/favicoon.png">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <title>PRFIT</title>
</head>
<body>
    <header>
        <nav class="menu">
            <img src="/PRfitR.png" class="logo" alt="">
            <ul>
                <li><a href="index.html" class="brillo">INICIO</a></li>
                <li><a href="Progresiones.html">Progresiones</a>
                <ul>
                    <li><a href="progressions/P5basico.html">5x5 básico</a></li>
                    <li><a href="progressions/PSmolovJR.html">SmolovJR</a></li>
                </ul></li>
                <li><a href="#">Ranking TOP</a>
                    <ul>
                        <li><a href="ranking/TCulturistas.html">Culturistas</a></li>
                        <li><a href="ranking/TPowerlifters.html">Powerlifters</a></li>
                    </ul></li>
                <li><a href="calorias.html">Calorias</a></li>
                <li><a href="contacto.html">Contacto</a></li>
                <li id="registerMenu"><a href="register.html"><img src="/user.png" alt=""></a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="main">
            <div class="rutina dieta">
                <br>
                <div id="resultados"></div>
            </div>

            <div class="rutina">
                <br>
                <div id="resultadoSBD"></div>
            </div>

            <div class="rutina">
                <br>
                <div id="resultados"></div>
            </div>

            <br>
            <button id="logoutButton">Desloguearse</button>
    </div>

    </main>

    <footer>

    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
        // Obtener el estado de la sesión del almacenamiento local
        var isLoggedIn = localStorage.getItem('isLoggedIn');
            console.log('isLoggedIn:', isLoggedIn);

            if (isLoggedIn) {
                var lastMenuItem = $('#registerMenu');
                var lastMenuItemLink = lastMenuItem.find('a');
                var lastMenuItemImg = lastMenuItem.find('img');

                if (lastMenuItemLink.length > 0) {
                    lastMenuItemLink.attr('href', '/perfil.html');
                }

                if (lastMenuItemImg.length > 0) {
                    lastMenuItemImg.attr('src', '/userlogged.png');
                }
                $.get('/mostrar_calorias', function(data, status) {
        // Verificar si la solicitud fue exitosa
                    if (status === 'success') {
                        // Mostrar los datos de calorías en el contenedor correspondiente
                        mostrarDatosCalorias(data);
                    } else {
                        // Manejar el caso de error si la solicitud no fue exitosa
                        console.error('Error al obtener los datos de calorías');
                    }
                });

                $.get('/mostrar_sbd', function(data, status) {
        // Verificar si la solicitud fue exitosa
                    if (status === 'success') {
                        // Mostrar los datos de calorías en el contenedor correspondiente
                        mostrarSBD(data);
                    } else {
                        // Manejar el caso de error si la solicitud no fue exitosa
                        console.error('Error al obtener los datos de SBD');
                    }
                });
                
            }else{

            }
        });

        $(document).ready(function() {
                // Manejador de eventos para el botón de deslogueo
            $('#logoutButton').on('click', function() {
                localStorage.removeItem('isLoggedIn');
                // Redirige al usuario a la página de logout
                window.location.href = '/logout';
            });


        });

        function mostrarDatosCalorias(data) {
        // Obtener el contenedor donde se mostrarán los datos de calorías
            var resultados = $('#resultados');

            // Construir el HTML para mostrar los datos
            var html = "<h2>Dieta</h2>";
            html += "<table border='1'>";
            html += "<tr><th>Calorias</th><th>Proteinas</th><th>Grasas</th></tr>";
            html += "<tr><td>"+ data.calorias +"</td><td>"+ data.proteinas +"</td><td>"+ data.grasas +"</td></tr>";
            html += "</table>";

            // Actualizar el contenido del contenedor con el HTML generado
            resultados.html(html);
        }

        function mostrarSBD(data) {
    // Obtener el contenedor donde se mostrarán los datos de la planificación de entrenamiento SBD
            var resultadoSBD = $('#resultadoSBD');

            // Construir el HTML para mostrar los datos
            var html = "<h2>Planificación de Entrenamiento SBD</h2>";
            html += "<table border='1'>";
            html += "<tr><th>Semana</th><th>Peso Sentadilla</th><th>Peso Banca</th><th>Peso Muerto</th></tr>";
            
            // Iterar sobre los datos recibidos y agregar cada fila a la tabla
            data.forEach(function(item) {
                html += "<tr>";
                html += "<td>" + item.semana + "</td>";
                html += "<td>" + item.peso_sentadilla + "</td>";
                html += "<td>" + item.peso_banca + "</td>";
                html += "<td>" + item.peso_muerto + "</td>";
                html += "</tr>";
            });
            
            html += "</table>";

            // Actualizar el contenido del contenedor con el HTML generado
            resultadoSBD.html(html);
        }



    </script>
    
</body>
</html><!--

██████╗  ██████╗  ███████╗ ██╗ █████████╗ 
██╔══██╗ ██╔══██╗ ██╔════╝ ██║ ╚══██╔══╝ 
██████╔╝ ██████╔╝ █████╗   ██║    ██║    
██╔═══╝  ██╔══██╗ ██╔══╝   ██║    ██║    
██║      ██║  ██║ ██║      ██║    ██║    
╚═╝      ╚═╝  ╚═╝ ╚═╝      ╚═╝    ╚═╝   

-->